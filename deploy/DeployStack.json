{
    "schemaVersion": "2.2",
    "description": "Deploy a docker stack to a cluster",
    "parameters": {
      "stackfile":{
        "type":"String",
        "description":"(Required) The location of the stack file to run"
      }
    },
    "mainSteps" : [
        {
            "action":"aws:runShellScript",
            "name":"FetchStackFile",
            "inputs":{
                "runCommand": [
                    "wget -O /tmp/services.yml {{ stackfile }}"
                ]
            }
        },
        {
            "action":"aws:runShellScript",
            "name":"DeployStacks",
            "inputs":{
                "runCommand": [
                    "docker stack deploy -c /tmp/services.yml homepagecore"
                ]
            }
        }
    ]
}